<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mandated Top Society</title>

<!-- ───────────────────────── CSS ───────────────────────── -->
<style>
:root{                 /* Light theme (default) */
  --bg:#f9f9f9;
  --text:#222;
  --accent:#5EC3FF;
}
[data-theme="dark"]{   /* Hungover Mode */
  --bg:#1A1A1A;
  --text:#EEE;
  --accent:#4FA4D9;
}

/* Reset + base */
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:sans-serif;line-height:1.5;background:var(--bg);color:var(--text);overflow-x:hidden}
a{color:var(--accent);text-decoration:none}
a:hover,a:focus{opacity:.8}
:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

/* Header */
header{position:fixed;inset:0 0 auto 0;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 1rem;background:var(--bg);border-bottom:1px solid rgba(0,0,0,.05);z-index:1000}
#menuBtn,#toggleTheme{background:none;border:none;font-size:1.5rem;color:var(--text);cursor:pointer}
#toggleTheme{font-size:.9rem;border:1px solid var(--accent);border-radius:4px;padding:.25rem .65rem}
#banner{max-height:48px;width:auto}

/* Sidebar */
#sidebar{position:fixed;top:0;left:-240px;width:240px;height:100%;background:var(--bg);box-shadow:2px 0 5px rgba(0,0,0,.1);transition:left .3s ease;z-index:1200;display:flex;flex-direction:column;padding-top:56px}
#sidebar a{padding:1rem;border-bottom:1px solid rgba(0,0,0,.05);color:var(--text)}
#overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);backdrop-filter:blur(2px);display:none;z-index:1100}

/* Main content */
main{padding:80px 1rem 120px}
section{margin-bottom:2rem}
.hero{display:flex;flex-direction:column;align-items:center;text-align:center;gap:1rem}
.hero h1{font-size:2rem}
.btn{display:inline-block;margin-top:.5rem;background:var(--accent);color:#fff;padding:.75rem 1.25rem;border:none;border-radius:4px;font-weight:600;cursor:pointer}
.btn:hover,.btn:focus{opacity:.9}

/* Products */
.products-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;margin-top:1rem}
.products-grid img{width:100%;border:1px solid rgba(0,0,0,.05);background:#fff;border-radius:8px;padding:.5rem}

/* Instagram */
#instaGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:1rem;margin-top:1rem}
#instaGrid img{width:100%;border-radius:8px}

/* Radio player */
#player{position:fixed;inset:auto 0 0 0;height:64px;background:var(--bg);border-top:1px solid rgba(0,0,0,.05);display:flex;align-items:center;justify-content:center;gap:1rem;padding:0 .5rem;z-index:1000}
#player button{background:none;border:none;font-size:1.25rem;color:var(--text);cursor:pointer}
#trackLabel{flex:1;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:.9rem}
#volume{width:100px}

/* Floating hats */
.hat-float{position:fixed;top:-100px;pointer-events:none;will-change:transform}
@keyframes drift{to{transform:translateX(-110vw) rotate(360deg)}}
@keyframes bob{50%{transform:translateY(-20px)}}
</style>
</head>
<body>

<!-- ─────────────────────── Overlay + Sidebar ─────────────────────── -->
<div id="overlay"></div>
<nav id="sidebar">
  <a href="https://mandatedtopsociety.com">Home</a>
  <a href="https://mandatedtopsociety.com/products">Products</a>
  <a href="https://mandatedtopsociety.com/tryon">Try On</a>
  <a href="https://mandatedtopsociety.com/radio">MTS Radio</a>
  <a href="https://instagram.com/mandatedtopsociety" target="_blank" rel="noopener">Instagram</a>
</nav>

<!-- ────────────────────────── Header ────────────────────────── -->
<header>
  <button id="menuBtn" aria-label="Menu">☰</button>
  <img id="banner" src="/images/banner.jpg" alt="Mandated Top Society banner">
  <button id="toggleTheme">Hungover Mode</button>
</header>

<!-- ────────────────────────── Main ────────────────────────── -->
<main>
  <!-- Hero -->
  <section class="hero">
    <h1>Welcome to the Mandated Top Society!</h1>
    <p>We advocate for government mandated top.</p>
    <a class="btn" href="https://mandatedtopsociety.com/tryon">Try On Our Hats</a>
  </section>

  <!-- Products -->
  <section id="products">
    <h2>Products</h2>
    <div class="products-grid">
      <img src="/images/white.png" alt="White Bucket Hat">
      <img src="/images/pink.png" alt="Pink Bucket Hat">
      <img src="/images/blue.png" alt="Blue Bucket Hat">
      <img src="/images/green.png" alt="Green Bucket Hat">
      <img src="/images/red.png" alt="Red Bucket Hat">
    </div>
    <a class="btn" href="https://mandatedtopsociety.com/tryon" style="margin-top:1rem">Try On Our Hats</a>
  </section>

  <!-- Instagram -->
  <section id="instagram">
    <h2>From the ’Gram</h2>
    <div id="instaGrid"></div>
  </section>
</main>

<!-- ─────────────────────── MTS Radio Player ─────────────────────── -->
<div id="player">
  <button id="prevBtn" aria-label="Previous">◀︎</button>
  <button id="playPauseBtn" aria-label="Play">▷</button>
  <button id="nextBtn" aria-label="Next">▶︎</button>
  <span id="trackLabel">MTS Radio</span>
  <input id="volume" type="range" min="0" max="1" step="0.01">
</div>

<!-- ───────────────────────── JavaScript ───────────────────────── -->
<script>
(()=>{/* IIFE keeps global scope clean */

 /* ── Sidebar ── */
 const sidebar=document.getElementById('sidebar');
 const overlay=document.getElementById('overlay');
 const openSidebar=()=>{sidebar.style.left='0';overlay.style.display='block'};
 const closeSidebar=()=>{sidebar.style.left='-240px';overlay.style.display='none'};
 document.getElementById('menuBtn').addEventListener('click',openSidebar);
 overlay.addEventListener('click',closeSidebar);
 sidebar.querySelectorAll('a').forEach(a=>a.addEventListener('click',closeSidebar));
 /* swipe‑to‑close */
 let startX=null;
 sidebar.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
 sidebar.addEventListener('touchmove',e=>{
   if(startX!==null && e.touches[0].clientX-startX>50) closeSidebar();
 });

 /* ── Hungover Mode ── */
 const root=document.documentElement;
 const toggleBtn=document.getElementById('toggleTheme');
 const setTheme=t=>{root.setAttribute('data-theme',t);localStorage.setItem('mts-theme',t)};
 setTheme(localStorage.getItem('mts-theme')||'light');
 toggleBtn.addEventListener('click',()=>setTheme(root.getAttribute('data-theme')==='dark'?'light':'dark'));

 /* ── Radio Player ── */
 const playlist=[
   {src:'/music/track1.mp3',artist:'Bloke 1',title:'Bucket Beat'},
   {src:'/music/track2.mp3',artist:'Bloke 2',title:'Suns Out'},
   {src:'/music/track3.mp3',artist:'Bloke 3',title:'Sunday Arvo'}
 ];
 const audio=new Audio(),label=document.getElementById('trackLabel');
 const playBtn=document.getElementById('playPauseBtn');
 let index=Math.floor(Math.random()*playlist.length);
 const load=i=>{const t=playlist[i];audio.src=t.src;label.textContent=`${t.artist} – ${t.title}`};
 load(index);
 const play=()=>{audio.play();playBtn.textContent='❚❚'};
 const pause=()=>{audio.pause();playBtn.textContent='▷'};
 playBtn.addEventListener('click',()=>audio.paused?play():pause());
 document.getElementById('prevBtn').addEventListener('click',()=>{index=(index-1+playlist.length)%playlist.length;load(index);play()});
 document.getElementById('nextBtn').addEventListener('click',()=>{index=(index+1)%playlist.length;load(index);play()});
 audio.addEventListener('ended',()=>document.getElementById('nextBtn').click());
 const vol=document.getElementById('volume');vol.value=audio.volume=.7;vol.addEventListener('input',()=>audio.volume=vol.value);

 /* ── Floating hats ── */
 const hatImgs=['white.png','pink.png','blue.png','green.png','red.png'];
 const spawnHat=()=>{
   const img=document.createElement('img');
   img.src='/images/'+hatImgs[Math.floor(Math.random()*hatImgs.length)];
   img.className='hat-float';
   const size=Math.random()*60+40;
   img.style.width=size+'px';
   img.style.top=Math.random()*window.innerHeight*0.6+40+'px';
   img.style.left='100vw';
   const dur=Math.random()*30+30;          /* 30‑60 s drift */
   img.style.animation=`drift ${dur}s linear forwards, bob 4s ease-in-out infinite alternate`;
   document.body.appendChild(img);
   setTimeout(()=>img.remove(),dur*1000);
 };
 setTimeout(spawnHat,2000);
 setInterval(spawnHat,Math.random()*15000+30000);/* 30‑45 s */

 /* ── Instagram Fetch (best‑effort; CORS‑safe proxy) ── */
 async function loadInsta(){
   try{
     const res=await fetch('https://r.jina.ai/http://www.instagram.com/mandatedtopsociety/?__a=1&__d=dis');
     if(!res.ok) throw 0;
     const data=await res.json();
     const posts=data.graphql.user.edge_owner_to_timeline_media.edges;
     const grid=document.getElementById('instaGrid');
     posts.slice(0,12).forEach(edge=>{
       const img=document.createElement('img');
       img.src=edge.node.thumbnail_src;
       img.alt='Instagram post';
       grid.appendChild(img);
     });
   }catch{document.getElementById('instaGrid').textContent='Could not load posts.'}
 }
 loadInsta();
})();/* IIFE end */
</script>
</body>
</html>